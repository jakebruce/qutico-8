pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--parallo
--by jake

function _init()
	basex=32
	basey=80
	
	player=make_player(basex,basey)
	entities={player}
	
	camx=player.x-basex
	camy=player.y-basey
	camtau=1
end
-->8
--updates

function _update60()
	for e in all(entities) do
		e:update()
	end
	update_camera()
end

function update_camera()
	camx=camtau*(player.x-basex)+(1-camtau)*camx
	camy=camtau*(player.y-basey)+(1-camtau)*camy
end

function update_player(s)
	if btn(⬅️) then
		s.v-=s.a
		s.f=true
	end if btn(➡️) then
		s.v+=s.a
		s.f=false
	end if not btn(⬅️) and not btn(➡️) then
		if abs(s.v)<abs(s.a) then
			s.v=0
			s.t=0
		else	
			s.v-=sgn(s.v)*s.a
		end
	end
	s.v=mid(-s.mv,s.v,s.mv)
	s.x+=s.v
	s.t+=1
end

-->8
--draws

function _draw()
	cls(12)
	camera(camx,camy)
	draw_background(64,0,32)
	draw_background(48,0,16)
	draw_background(32,0,8)
	draw_background(16,0,4)
	draw_background(0,0,1)
	for e in all(entities) do
		e:draw()
	end
end

function draw_background(mx,my,level)
	x=flr(player.x/128/level)
	dx=(1-1/level)*player.x
	
	map(mx,my,x*128-128+dx,0,16,16)
	map(mx,my,x*128+  0+dx,0,16,16)
	map(mx,my,x*128+128+dx,0,16,16)
end

function draw_player(s)
	n=s.n[flr(s.t/s.s)%#s.n+1]
	spr(n,s.x,s.y,1,1,s.f)
end
-->8
--entities

function make_player(x,y)
	return {
		x=x,
		y=y,
		v=0,
		a=0.3,
		mv=2,
		t=0,
		s=8,
		n={1,2,3},
		update=update_player,
		draw=draw_player,
	}
end
__gfx__
00000000000f1f100000f1f100f1f100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000f00000f7f700000f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000f777f000f777ff00f777f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000f777f000ffcc0000fff7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000fcccf0000c00c0000ccff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000c0c00000c00c000c0c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000c0c00000c00ff00c00c00000000000000000000000000000000000000000000033000000000000000000000000000000005555555000000000000
00000000000f0ff0000ff00000ff0ff0000000000000000000000000000000000000000000033000000000000000000000000000000055555555555000000000
00000000000000000000000000000000000000000000000000000000000000000000000000033300000000000000000000000000000555555555555555550000
000000000000000000000000000000000000000000000000000000000000000000000000000b3300000000000000000000000000005555555555555555555500
00000000000000000000000000000000000000000000000000000000000000000000000000333300000000003300000000000000055555555555555555555550
00000000000000000000000000000000000000000000000000000000000000000000030000333330000000003300000000000000555555555555555555555555
00000000000000000000000000000000000000000000000000000000000000000000330000333330000000033330000000000055556555555555565555555555
0000000000000000000000000000000000000000000000000000000000000000000333330033b330000000033333300005555555556555555555566655555555
0000000000000000000000000000000000000000000000000000000000000000003333330333333000000003b333300055555555566555555555555665555555
0000000000000000000000000000000000000000000000000000000000000000003b33333333333000000003333b300055555555665555655555555556655555
0000000044444444333333330000000000000000000000000000000000000000033333b333044030000000333333300055555556655555655555555555665555
00000000444944443333333400000000000000000000000000000000000000000333333330044000330000333433300055555556555555565555555555565555
00000000444444543444335400000000000000000000000000000000000000003333b33330044003333000b33443300055555566555555565555555555556655
00000000445444444454434400000000000000000000000000000000000000003333333330044003b33300004440000055555665555555566555555555555665
00000000444444444444444400000000000000000000000000000000000000000000344030044033333300004440000055555655555555556555555555555565
0000000044444544444445440000000000000000000000000000000000000000000004400004403333b300000440000055556655555555556555555555555555
00000000454444444544444400000000000000000000000000000000000000000000044000044003440000000440000055555555555555556555555555555555
00000000444444494444444900000000000000000000000000000000000000000000044000044000440000000440000055555555555555556655555555555555
00000000000000000000000000000000000000000000000000000000000000000000044000044000440000000440000055555555555555555655555555555555
00000000000000000000000000000000000000000000000000000000000000000000043333333300433333333343333055555555555555556655555555555555
00000000000000000000000000000000000000000000000000000000000000000000333333333333333333333333333355555555555555555655555555555555
00000000000000000000000000000000000000000000000000000000000000003333333333333333333333993333333355555555555555555555555555555555
00000000000000000000000000000000000000000000000000000000000000009333339933333333333399933339999355555555555555555555555555555555
00000000000000000000000000000000000000000000000000000000000000009933333333339993333333333333333355555555555555555555555555555555
00000000000000000000000000000000000000000000000000000000000000003333333333333399333333333333333355555555555555555555555555555555
00000000000000000000000000000000000000000000000000000000000000004444444444444444444444444444444455555555555555555555555555555555
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a9999999999999999999999999999a7
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a99999999999999999999999999a70
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007aa9999999999999999999999aa700
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077aaaa99999999999999aaaa77000
000000000000000000000000000000000000000000000000000000000000000000000000000000000007777770000000000007777aaaaaaaaaaaaaa777700000
00000000000000000000000000000000000000000000000000000000000000000000000000000000007666666700000000000000077777777777777000000000
00000000000000000000000000000000000000000000000000000000000000000000000000777770076666666670000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000007666667766666666667000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000076666666766666666667000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000766666666776666666667000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000766666666776666666667000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000766666666676666666670000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000766666777777667777770000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000077777777666767777777667000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000766667776667666776666666700000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000007666666777776667676666666670000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000076666667666766667667666666670000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000076666667666766667667666666670000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000076666667666766667667666666670000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000076666666766766667676666666670000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000076666666766766666776666666700000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000007666666677666677777666667000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000766666670777776667777770000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000077777700076666666667000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000076666666667000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000076666666667000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000007766666770000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000077777000000000000000000000000000000000000000000
__map__
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c4d4e4f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048494a4b00000000000000005c5d5e5f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058595a5b0000000048494a4b6c6d6e6f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048494a4b68696a6b0000000058595a5b7c7d7e7f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058595a5b78797a7b48494a4b68696a6b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000c0d0e0f0c0d0e0f0c0d0e0f0c0d0e0f68696a6b0000000058595a5b78797a7b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000022222222000000000000000000000000000000000000001c1d1e1f1c1d1e1f1c1d1e1f1c1d1e1f78797a7b0000000068696a6b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000008090a0b08090a0b08090a0b08090a0b2c2d2e2f2c2d2e2f2c2d2e2f2c2d2e2f000000000000000078797a7b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000018191a1b18191a1b18191a1b18191a1b3c3d3e3f3c3d3e3f3c3d3e3f3c3d3e3f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000028292a2b28292a2b28292a2b28292a2b3c3c3d3e3f3d3e3f3c3d3e3f3c3d3e3f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000038393a3b38393a3b38393a3b38393a3b3c3d3e3f3c3d3e3f3c3d3e3f3c3d3e3f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2222222222222222222222222222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2121212121212121212121212121212100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2121212121212121212121212121212100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2121212121212121212121212121212100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2121212121212121212121212121212100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
